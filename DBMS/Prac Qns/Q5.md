```
Customer_details => cid, cname, mobno, email, city

Account_info => Ac_no, Ac_type, Balance,

branch_name, cid

For the given table structure, execute followings.

a. Display type of accounts (saving or current) opened by customer 'Ajay'

b. Display values from Balance column after adding 7% interest to all accounts

c. A VIEW to show total balance amount per branch

d. Display all records from first table using JDBC connection

6. Table: Employee =>

```

Complete Solution for Customer-Account Database System

ðŸ“Œ STEP 1: CREATE TABLES WITH PROPER STRUCTURE

```sql
-- Create Customer_details table
CREATE TABLE Customer_details (
    cid INT PRIMARY KEY,
    cname VARCHAR(100) NOT NULL,
    mobno VARCHAR(15),
    email VARCHAR(100),
    city VARCHAR(50)
);

-- Create Account_info table
CREATE TABLE Account_info (
    Ac_no VARCHAR(20) PRIMARY KEY,
    Ac_type VARCHAR(20) CHECK (Ac_type IN ('Saving', 'Current', 'Fixed')),
    Balance DECIMAL(12, 2) DEFAULT 0.00,
    branch_name VARCHAR(100),
    cid INT,
    FOREIGN KEY (cid) REFERENCES Customer_details(cid)
);
```

ðŸ“Œ STEP 2: INSERT SAMPLE DATA

```sql
-- Insert Customer Data
INSERT INTO Customer_details (cid, cname, mobno, email, city) VALUES
(101, 'Ajay Sharma', '9876543210', 'ajay.sharma@email.com', 'Mumbai'),
(102, 'Priya Patel', '8765432109', 'priya.patel@email.com', 'Delhi'),
(103, 'Raj Kumar', '7654321098', 'raj.kumar@email.com', 'Bangalore'),
(104, 'Anjali Singh', '6543210987', 'anjali.singh@email.com', 'Chennai'),
(105, 'Vikram Gupta', '5432109876', 'vikram.gupta@email.com', 'Kolkata'),
(106, 'Ajay Verma', '4321098765', 'ajay.verma@email.com', 'Hyderabad'),
(107, 'Sneha Reddy', '3210987654', 'sneha.reddy@email.com', 'Pune'),
(108, 'Rahul Mehta', '2109876543', 'rahul.mehta@email.com', 'Ahmedabad');

-- Insert Account Data
INSERT INTO Account_info (Ac_no, Ac_type, Balance, branch_name, cid) VALUES
('AC001', 'Saving', 50000.00, 'Mumbai Central', 101),
('AC002', 'Current', 250000.00, 'Mumbai Central', 101),
('AC003', 'Saving', 75000.00, 'Delhi South', 102),
('AC004', 'Fixed', 1000000.00, 'Delhi North', 102),
('AC005', 'Saving', 30000.00, 'Bangalore East', 103),
('AC006', 'Current', 150000.00, 'Bangalore West', 103),
('AC007', 'Saving', 45000.00, 'Chennai Central', 104),
('AC008', 'Current', 200000.00, 'Chennai Central', 104),
('AC009', 'Saving', 60000.00, 'Kolkata Main', 105),
('AC010', 'Saving', 55000.00, 'Hyderabad City', 106),
('AC011', 'Current', 300000.00, 'Hyderabad City', 106),
('AC012', 'Saving', 40000.00, 'Pune Branch', 107),
('AC013', 'Fixed', 800000.00, 'Ahmedabad Main', 108),
('AC014', 'Saving', 35000.00, 'Ahmedabad Main', 108);
```

---

âœ… a. DISPLAY TYPE OF ACCOUNTS OPENED BY CUSTOMER 'AJAY'

Solution 1: Using JOIN

```sql
SELECT 
    cd.cid AS Customer_ID,
    cd.cname AS Customer_Name,
    ai.Ac_no AS Account_Number,
    ai.Ac_type AS Account_Type,
    ai.Balance,
    ai.branch_name AS Branch
FROM Customer_details cd
INNER JOIN Account_info ai ON cd.cid = ai.cid
WHERE cd.cname LIKE 'Ajay%'
ORDER BY ai.Ac_type, ai.Ac_no;
```

Solution 2: Using Subquery

```sql
SELECT 
    Ac_no AS Account_Number,
    Ac_type AS Account_Type,
    Balance,
    branch_name AS Branch
FROM Account_info
WHERE cid IN (
    SELECT cid 
    FROM Customer_details 
    WHERE cname LIKE 'Ajay%'
)
ORDER BY Ac_type, Ac_no;
```

Solution 3: Detailed Summary

```sql
SELECT 
    cd.cname AS Customer_Name,
    ai.Ac_type AS Account_Type,
    COUNT(ai.Ac_no) AS Number_of_Accounts,
    SUM(ai.Balance) AS Total_Balance,
    STRING_AGG(ai.Ac_no, ', ') AS Account_Numbers
FROM Customer_details cd
JOIN Account_info ai ON cd.cid = ai.cid
WHERE cd.cname LIKE 'Ajay%'
GROUP BY cd.cname, ai.Ac_type
ORDER BY ai.Ac_type;
```

Expected Output:

```
Customer_ID | Customer_Name | Account_Number | Account_Type | Balance   | Branch
-----------|---------------|----------------|--------------|-----------|---------------
101        | Ajay Sharma   | AC001          | Saving       | 50000.00  | Mumbai Central
101        | Ajay Sharma   | AC002          | Current      | 250000.00 | Mumbai Central
106        | Ajay Verma    | AC010          | Saving       | 55000.00  | Hyderabad City
106        | Ajay Verma    | AC011          | Current      | 300000.00 | Hyderabad City
```

---

âœ… b. DISPLAY VALUES FROM BALANCE COLUMN AFTER ADDING 7% INTEREST

Solution 1: Calculate Interest Without Modifying Data

```sql
SELECT 
    Ac_no AS Account_Number,
    Ac_type AS Account_Type,
    Balance AS Current_Balance,
    ROUND(Balance * 0.07, 2) AS Interest_Amount,
    ROUND(Balance * 1.07, 2) AS New_Balance_After_Interest
FROM Account_info
ORDER BY Ac_no;
```

Solution 2: Apply Interest to Specific Account Types

```sql
-- Apply 7% interest only to Saving and Fixed accounts
SELECT 
    Ac_no,
    Ac_type,
    Balance AS Current_Balance,
    CASE 
        WHEN Ac_type IN ('Saving', 'Fixed') 
        THEN ROUND(Balance * 1.07, 2)
        ELSE Balance
    END AS Balance_With_Interest,
    CASE 
        WHEN Ac_type IN ('Saving', 'Fixed') 
        THEN ROUND(Balance * 0.07, 2)
        ELSE 0.00
    END AS Interest_Applied
FROM Account_info
ORDER BY Ac_type, Ac_no;
```

Solution 3: Update Balance with 7% Interest

```sql
-- First, check current balances
SELECT 
    Ac_no,
    Balance AS Old_Balance,
    ROUND(Balance * 1.07, 2) AS New_Balance
FROM Account_info;

-- Apply 7% interest to all accounts (UPDATE)
UPDATE Account_info
SET Balance = ROUND(Balance * 1.07, 2);

-- Verify the update
SELECT 
    Ac_no,
    Ac_type,
    Balance AS Updated_Balance
FROM Account_info
ORDER BY Ac_no;
```

Solution 4: Calculate Total Interest Paid

```sql
SELECT 
    COUNT(*) AS Total_Accounts,
    SUM(Balance) AS Total_Balance_Before,
    SUM(ROUND(Balance * 0.07, 2)) AS Total_Interest_Payable,
    SUM(ROUND(Balance * 1.07, 2)) AS Total_Balance_After,
    ROUND(AVG(Balance), 2) AS Average_Balance_Before,
    ROUND(AVG(ROUND(Balance * 1.07, 2)), 2) AS Average_Balance_After
FROM Account_info;
```

---

âœ… c. CREATE A VIEW TO SHOW TOTAL BALANCE AMOUNT PER BRANCH

Solution 1: Basic View

```sql
-- Create View
CREATE VIEW Branch_Wise_Balance AS
SELECT 
    branch_name AS Branch_Name,
    COUNT(Ac_no) AS Total_Accounts,
    SUM(Balance) AS Total_Balance,
    ROUND(AVG(Balance), 2) AS Average_Balance,
    MIN(Balance) AS Minimum_Balance,
    MAX(Balance) AS Maximum_Balance
FROM Account_info
GROUP BY branch_name
ORDER BY Total_Balance DESC;

-- Query the View
SELECT * FROM Branch_Wise_Balance;

-- Get specific branch details
SELECT * FROM Branch_Wise_Balance 
WHERE Branch_Name = 'Mumbai Central';
```

Solution 2: Detailed View with Account Type Breakdown

```sql
-- Create Detailed View
CREATE VIEW Branch_Detailed_Summary AS
SELECT 
    branch_name AS Branch_Name,
    Ac_type AS Account_Type,
    COUNT(Ac_no) AS Number_of_Accounts,
    SUM(Balance) AS Total_Balance,
    ROUND(SUM(Balance) * 100.0 / SUM(SUM(Balance)) OVER (PARTITION BY branch_name), 2) AS Percentage_of_Branch_Total
FROM Account_info
GROUP BY branch_name, Ac_type
ORDER BY branch_name, Total_Balance DESC;

-- Query the View
SELECT * FROM Branch_Detailed_Summary;

-- Get summary by branch
SELECT 
    Branch_Name,
    SUM(Number_of_Accounts) AS Total_Accounts,
    SUM(Total_Balance) AS Grand_Total
FROM Branch_Detailed_Summary
GROUP BY Branch_Name
ORDER BY Grand_Total DESC;
```

Solution 3: View with Customer Count

```sql
-- View showing branch performance with customer count
CREATE VIEW Branch_Performance AS
SELECT 
    ai.branch_name AS Branch_Name,
    COUNT(DISTINCT ai.cid) AS Unique_Customers,
    COUNT(ai.Ac_no) AS Total_Accounts,
    SUM(ai.Balance) AS Total_Deposits,
    ROUND(SUM(ai.Balance) / COUNT(DISTINCT ai.cid), 2) AS Average_Balance_Per_Customer,
    ROUND(AVG(ai.Balance), 2) AS Average_Account_Balance
FROM Account_info ai
GROUP BY ai.branch_name
ORDER BY Total_Deposits DESC;

-- Query the View
SELECT * FROM Branch_Performance;

-- Top performing branches
SELECT TOP 3 * FROM Branch_Performance 
ORDER BY Total_Deposits DESC;
```

Solution 4: Update the View

```sql
-- To modify an existing view
CREATE OR REPLACE VIEW Branch_Wise_Balance AS
SELECT 
    branch_name AS Branch_Name,
    COUNT(Ac_no) AS Total_Accounts,
    SUM(Balance) AS Total_Balance,
    ROUND(AVG(Balance), 2) AS Average_Balance,
    MIN(Balance) AS Minimum_Balance,
    MAX(Balance) AS Maximum_Balance,
    COUNT(DISTINCT cid) AS Unique_Customers
FROM Account_info
GROUP BY branch_name
ORDER BY Total_Balance DESC;
```

---

âœ… d. DISPLAY ALL RECORDS FROM FIRST TABLE USING JDBC CONNECTION

Java JDBC Code for Customer_details Table:

```java
import java.sql.*;

public class CustomerDetailsJDBC {
    
    // Database connection parameters
    private static final String URL = "jdbc:mysql://localhost:3306/BankDB";
    private static final String USER = "root";
    private static final String PASSWORD = "password";
    
    public static void main(String[] args) {
        Connection connection = null;
        Statement statement = null;
        ResultSet resultSet = null;
        
        try {
            // 1. Load the JDBC driver
            Class.forName("com.mysql.cj.jdbc.Driver");
            
            // 2. Establish connection
            connection = DriverManager.getConnection(URL, USER, PASSWORD);
            System.out.println("Database connected successfully!");
            
            // 3. Create statement
            statement = connection.createStatement();
            
            // 4. Execute query to fetch all records from Customer_details
            String query = "SELECT * FROM Customer_details ORDER BY cid";
            resultSet = statement.executeQuery(query);
            
            // 5. Display results in formatted table
            System.out.println("\n========== CUSTOMER DETAILS ==========");
            System.out.println("+-----+----------------+----------------+--------------------------------+--------------+");
            System.out.println("| CID | Customer Name  | Mobile Number  | Email                          | City         |");
            System.out.println("+-----+----------------+----------------+--------------------------------+--------------+");
            
            int count = 0;
            while (resultSet.next()) {
                int cid = resultSet.getInt("cid");
                String cname = resultSet.getString("cname");
                String mobno = resultSet.getString("mobno");
                String email = resultSet.getString("email");
                String city = resultSet.getString("city");
                
                // Format and display
                System.out.printf("| %-3d | %-14s | %-14s | %-30s | %-12s |\n", 
                    cid, cname, mobno, email, city);
                count++;
            }
            
            System.out.println("+-----+----------------+----------------+--------------------------------+--------------+");
            System.out.println("Total Records: " + count);
            
            // 6. Display summary statistics
            displaySummary(connection);
            
        } catch (ClassNotFoundException e) {
            System.err.println("JDBC Driver not found!");
            e.printStackTrace();
        } catch (SQLException e) {
            System.err.println("Database connection error!");
            e.printStackTrace();
        } finally {
            // 7. Close resources
            try {
                if (resultSet != null) resultSet.close();
                if (statement != null) statement.close();
                if (connection != null) connection.close();
                System.out.println("\nDatabase connection closed.");
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }
    }
    
    // Method to display summary statistics
    private static void displaySummary(Connection connection) throws SQLException {
        String summaryQuery = """
            SELECT 
                COUNT(*) AS total_customers,
                COUNT(DISTINCT city) AS cities_covered,
                GROUP_CONCAT(DISTINCT city ORDER BY city) AS city_list
            FROM Customer_details
            """;
        
        Statement stmt = connection.createStatement();
        ResultSet rs = stmt.executeQuery(summaryQuery);
        
        if (rs.next()) {
            System.out.println("\n========== SUMMARY STATISTICS ==========");
            System.out.println("Total Customers: " + rs.getInt("total_customers"));
            System.out.println("Cities Covered: " + rs.getInt("cities_covered"));
            System.out.println("Cities: " + rs.getString("city_list"));
        }
        
        rs.close();
        stmt.close();
    }
}
```

Alternative: Using PreparedStatement with Parameterized Query

```java
import java.sql.*;

public class CustomerDetailsAdvanced {
    
    private static final String URL = "jdbc:mysql://localhost:3306/BankDB";
    private static final String USER = "root";
    private static final String PASSWORD = "password";
    
    public static void main(String[] args) {
        try (Connection conn = DriverManager.getConnection(URL, USER, PASSWORD)) {
            
            System.out.println("Connected to database!");
            
            // Method 1: Display all customers
            displayAllCustomers(conn);
            
            // Method 2: Search customers by city
            searchCustomersByCity(conn, "Mumbai");
            
            // Method 3: Display customer count by city
            displayCustomerCountByCity(conn);
            
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
    
    public static void displayAllCustomers(Connection conn) throws SQLException {
        String query = """
            SELECT cid, cname, mobno, email, city 
            FROM Customer_details 
            ORDER BY cname
            """;
        
        try (Statement stmt = conn.createStatement();
             ResultSet rs = stmt.executeQuery(query)) {
            
            System.out.println("\n=== ALL CUSTOMERS ===");
            System.out.printf("%-5s %-20s %-15s %-30s %-15s\n", 
                "CID", "Name", "Mobile", "Email", "City");
            System.out.println("-".repeat(90));
            
            while (rs.next()) {
                System.out.printf("%-5d %-20s %-15s %-30s %-15s\n",
                    rs.getInt("cid"),
                    rs.getString("cname"),
                    rs.getString("mobno"),
                    rs.getString("email"),
                    rs.getString("city"));
            }
        }
    }
    
    public static void searchCustomersByCity(Connection conn, String city) throws SQLException {
        String query = "SELECT * FROM Customer_details WHERE city = ? ORDER BY cname";
        
        try (PreparedStatement pstmt = conn.prepareStatement(query)) {
            pstmt.setString(1, city);
            
            ResultSet rs = pstmt.executeQuery();
            
            System.out.println("\n=== CUSTOMERS IN " + city.toUpperCase() + " ===");
            boolean hasResults = false;
            
            while (rs.next()) {
                if (!hasResults) {
                    hasResults = true;
                    System.out.printf("%-5s %-20s %-15s %-30s\n", 
                        "CID", "Name", "Mobile", "Email");
                    System.out.println("-".repeat(75));
                }
                
                System.out.printf("%-5d %-20s %-15s %-30s\n",
                    rs.getInt("cid"),
                    rs.getString("cname"),
                    rs.getString("mobno"),
                    rs.getString("email"));
            }
            
            if (!hasResults) {
                System.out.println("No customers found in " + city);
            }
            
            rs.close();
        }
    }
    
    public static void displayCustomerCountByCity(Connection conn) throws SQLException {
        String query = """
            SELECT city, COUNT(*) as customer_count 
            FROM Customer_details 
            GROUP BY city 
            ORDER BY customer_count DESC
            """;
        
        try (Statement stmt = conn.createStatement();
             ResultSet rs = stmt.executeQuery(query)) {
            
            System.out.println("\n=== CUSTOMER DISTRIBUTION BY CITY ===");
            System.out.printf("%-15s %-15s\n", "City", "Customer Count");
            System.out.println("-".repeat(30));
            
            while (rs.next()) {
                System.out.printf("%-15s %-15d\n",
                    rs.getString("city"),
                    rs.getInt("customer_count"));
            }
        }
    }
}
```

Complete JDBC Application with CRUD Operations:

```java
import java.sql.*;
import java.util.Scanner;

public class BankCustomerManagementSystem {
    
    private static final String URL = "jdbc:mysql://localhost:3306/BankDB";
    private static final String USER = "root";
    private static final String PASSWORD = "password";
    
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        
        try {
            Class.forName("com.mysql.cj.jdbc.Driver");
            Connection connection = DriverManager.getConnection(URL, USER, PASSWORD);
            
            System.out.println("=== BANK CUSTOMER MANAGEMENT SYSTEM ===");
            
            boolean exit = false;
            while (!exit) {
                System.out.println("\nMenu:");
                System.out.println("1. Display All Customers");
                System.out.println("2. Add New Customer");
                System.out.println("3. Update Customer Details");
                System.out.println("4. Delete Customer");
                System.out.println("5. Search Customer by ID");
                System.out.println("6. Display Customer with Accounts");
                System.out.println("7. Exit");
                System.out.print("Enter your choice: ");
                
                int choice = scanner.nextInt();
                scanner.nextLine(); // Consume newline
                
                switch (choice) {
                    case 1:
                        displayAllCustomers(connection);
                        break;
                    case 2:
                        addNewCustomer(connection, scanner);
                        break;
                    case 3:
                        updateCustomer(connection, scanner);
                        break;
                    case 4:
                        deleteCustomer(connection, scanner);
                        break;
                    case 5:
                        searchCustomerById(connection, scanner);
                        break;
                    case 6:
                        displayCustomersWithAccounts(connection);
                        break;
                    case 7:
                        exit = true;
                        System.out.println("Thank you for using the system!");
                        break;
                    default:
                        System.out.println("Invalid choice! Please try again.");
                }
            }
            
            connection.close();
            scanner.close();
            
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    
    private static void displayAllCustomers(Connection conn) throws SQLException {
        String query = "SELECT * FROM Customer_details ORDER BY cid";
        Statement stmt = conn.createStatement();
        ResultSet rs = stmt.executeQuery(query);
        
        System.out.println("\n=== ALL CUSTOMERS ===");
        System.out.printf("%-5s %-20s %-15s %-30s %-15s\n", 
            "CID", "Name", "Mobile", "Email", "City");
        System.out.println("-".repeat(90));
        
        int count = 0;
        while (rs.next()) {
            System.out.printf("%-5d %-20s %-15s %-30s %-15s\n",
                rs.getInt("cid"),
                rs.getString("cname"),
                rs.getString("mobno"),
                rs.getString("email"),
                rs.getString("city"));
            count++;
        }
        
        System.out.println("\nTotal Customers: " + count);
        
        rs.close();
        stmt.close();
    }
    
    private static void addNewCustomer(Connection conn, Scanner scanner) throw
